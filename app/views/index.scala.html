@import model.Question
@import play.api.Logger
@import messages.ClientState
@(questionString: String)(url: String)

<!DOCTYPE html>

<html>
    <head>
        <title>"Smart Lift</title>
        <link rel="stylesheet" media="screen" href="@routes.Assets.at("stylesheets/main.css")">
        <link rel="shortcut icon" type="image/png" href="@routes.Assets.at("images/elevico.png")">
        <script src="@routes.Assets.at("javascripts/jquery-1.9.0.min.js")" type="text/javascript"></script>
    </head>
    <body>

        <script type="text/javascript" >

                var telSocket = new WebSocket("@url");

                telSocket.onopen = function () {
                };

                telSocket.onclose = function (event) {
                    if (event.wasClean) {
                        alert('Соединение закрыто чисто');
                    } else {
                        alert('Обрыв соединения');
                    }
                    alert('Код: ' + event.code + ' причина: ' + event.reason);
                };

                telSocket.onmessage = function (event) {
                    var data = event.data;
                    data = JSON.parse(data);
                    if (data.state != undefined) {
                        var state = data.state;
                        if (state == "@ClientState.UP") {
                            document.getElementById("online").style.display = "block"
                        }
                        if (state == "@ClientState.DOWN") {
                            document.getElementById("online").style.display = "none";
                            alert("Клиент отключился")
                        }
                    }
                };

                telSocket.onerror = function (error) {
                    alert("Ошибка " + error.message);
                };

        </script>

        <p>Test server</p>
        @helper.form(action = routes.WSController.pickQuestion()) {
            <input type="submit" value="Выбрать вопрос"/>
        }
        @if(!questionString.equals(Question.NOT_SET)) {
            @helper.form(action = routes.WSController.send) {
                <input type="submit" value="Задать--->"/>
            }
        }

        <u>Текущий вопрос:</u>
        @questionString
        @if(!questionString.equals(Question.NOT_SET)) {
            @helper.form(action = routes.WSController.pickVariant()) {
                <button type="submit" name="send_variant" value="var_1">Variant 1</button>
                <button type="submit" name="send_variant" value="var_2">Variant 2</button>
                <br>
                <button type="submit" name="send_variant" value="var_3">Variant 3</button>
                <button type="submit" name="send_variant" value="var_4">Variant 4</button>
            }

            @helper.form(action = routes.WSController.questionAction()) {
                <button type="submit" name="qaction" value="check">Правлильный вариант</button>
                <button type="submit" name="qaction" value="expand">Ответ развёрнутый</button>
                <button type="submit" name="qaction" value="done">Вопрос сыграл</button>
            }
        }
        @*<img src="@routes.Assets.at("images/screenshot.png")" />*@

        @*<script type='text/javascript' src='@routes.Assets.at("lib/jquery/jquery.js")'></script>*@
        @*<script type='text/javascript' src='@routes.Assets.at("lib/flot/jquery.flot.js")'></script>*@
        <div style="display: none;">
            JS buttons

            <br>
            <button onclick="telSocket.send('var_1');">JS Variant 1</button>
            <button onclick="telSocket.send('var_2');">JS Variant 2</button>
            <br>
            <button onclick="telSocket.send('var_3');">JS Variant 3</button>
            <button onclick="telSocket.send('var_4');">JS Variant 4</button>
        </div>
        <div id = "online" style="display: none">
            Клиент Онлайн
        </div>
    </body>
</html>
